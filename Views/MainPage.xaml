<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:SilksongSaveSync.ViewModels"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             x:Class="SilksongSaveSync.Views.MainPage"
             x:DataType="vm:MainViewModel"
             Title="Silksong Save Sync">

    <ContentPage.Resources>
        <ResourceDictionary>
            <toolkit:InvertedBoolConverter x:Key="InvertedBoolConverter" />
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid RowDefinitions="Auto, Auto, Auto, *" Padding="20" RowSpacing="20">

        <!-- Status Area -->
        <Frame Grid.Row="0" BackgroundColor="{Binding StatusColor}" Padding="20" CornerRadius="10" HasShadow="True">
            <Label Text="{Binding StatusMessage}" 
                   FontSize="24" 
                   HorizontalOptions="Center" 
                   TextColor="White"
                   FontAttributes="Bold"/>
        </Frame>

        <!-- Path Selection -->
        <VerticalStackLayout Grid.Row="1" Spacing="15">
            <Label Text="Steam Save Folder" FontAttributes="Bold" FontSize="Medium"/>
            <Grid ColumnDefinitions="*, Auto" ColumnSpacing="10">
                <Entry Text="{Binding SteamPath}" Placeholder="Select Steam save folder..." IsReadOnly="False"/>
                <Button Text="Browse" Command="{Binding BrowseSteamCommand}" Grid.Column="1"/>
            </Grid>

            <Label Text="Xbox Save Folder" FontAttributes="Bold" FontSize="Medium"/>
            <Grid ColumnDefinitions="*, Auto" ColumnSpacing="10">
                <Entry Text="{Binding XboxPath}" Placeholder="Select Xbox save folder..." IsReadOnly="False"/>
                <Button Text="Browse" Command="{Binding BrowseXboxCommand}" Grid.Column="1"/>
            </Grid>
        </VerticalStackLayout>

        <!-- Sync Button -->
        <Button Grid.Row="2" 
                Text="Sync Now" 
                Command="{Binding SyncCommand}" 
                FontSize="Large" 
                FontAttributes="Bold"
                HeightRequest="60"
                CornerRadius="8"
                IsEnabled="{Binding IsBusy, Converter={StaticResource InvertedBoolConverter}}"/>

        <!-- Logs -->
        <Grid Grid.Row="3" RowDefinitions="Auto, *">
            <Label Grid.Row="0" Text="Activity Log" FontAttributes="Bold" Margin="0,0,0,5"/>
            <Frame Grid.Row="1" BorderColor="{StaticResource Primary}" Padding="5" BackgroundColor="#FAFAFA" HasShadow="False">
                <CollectionView ItemsSource="{Binding Logs}"
                                ItemsUpdatingScrollMode="KeepLastItemInView">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Label Text="{Binding .}" 
                                   FontSize="12" 
                                   TextColor="#333333" 
                                   LineBreakMode="WordWrap"
                                   Padding="5,2"/>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </Frame>
        </Grid>

    </Grid>

</ContentPage>

